doctype html
//html(ng-app="habitrpg", ng-controller="RootCtrl", ng-class='{"applying-action":applyingAction}', ui-keypress="{27:'castCancel()'}")
html(ng-app='habitrpg', ng-controller="RootCtrl", ng-class='{"applying-action":applyingAction}', ui-keyup="{27:'castCancel()'}", ng-keydown="$broadcast('habit:keydown', $event)", ng-keyup="$broadcast('habit:keyup', $event)")
  head
    title(ng-bind="env.t('habitica') + ' | ' + $root.pageTitle")
    // ?v=1 needed to force refresh
    link(rel='shortcut icon', sizes="32x32", href='#{env.getBuildUrl("favicon.ico")}?v=4')
    link(rel='shortcut icon', sizes="144x144", href='#{env.getBuildUrl("favicon_192x192.png")}?v=4')
    link(rel='mask-icon', href='#{env.getBuildUrl("favicon.ico")}?v=4')

    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width, initial-scale=1.0')
    meta(name='apple-mobile-web-app-capable', content='yes')
    meta(name='mobile-web-app-capable', content='yes')

    != env.getManifestFiles("app", "css")

    // Does not work correctly inside .css file
    style(type='text/css').
      [ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak {
        display: none !important;
      }

    //webfonts
    link(href='//fonts.googleapis.com/css?family=Lato:300,400,700,400italic,700italic', rel='stylesheet', type='text/css')
  body
    #loadingScreen(ng-if='!appLoaded')
      // Image inlined to avoid lag while loading (~6KB)
      img(src='data:image/png;base64,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')
      .spinner
        .spinner__item1
        .spinner__item2
        .spinner__item3
        .spinner__item4
    .ng-cloak(ng-if='appLoaded', ng-controller='GroupsCtrl')
      include ./shared/mixins
      include ./shared/avatar/index
      include ./shared/header/menu
      include ./shared/modals/index
      include ./shared/header/header
      include ./shared/tasks/index
      include ./main/index
      include ./options/index

      #notification-area(ng-controller='NotificationCtrl')
      #wrap.container-fluid
        .row
          .col-md-12.exp-chart(ng-show='charts.exp')
          #main(ui-view)

      include ./shared/footer
    include ./shared/noscript

    // Load javascript at the end
    script(type='text/javascript').
     window.env = !{JSON.stringify(env._.pick(env, env.clientVars))};

    != env.getManifestFiles('app', 'js')

    // TODO for some reason this won't load when in footerCtrl.js#deferredScripts()
    script(type='text/javascript', src='//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5016f6cc44ad68a4', async='async')
